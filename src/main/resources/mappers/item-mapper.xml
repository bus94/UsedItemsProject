<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="com.ss.useditems.mapper.ItemEnrollMapper">

	<select id="selectItemIndex" resultType="int">
		SELECT
		item_index
		FROM
		item
		WHERE
		ROWNUM = 1
		ORDER BY
		item_index DESC
	</select>

	<insert id="enrollItem" parameterType="itemInfoDTO">
		INSERT ALL
		INTO ITEM
		VALUES(ITEM_SEQ.NEXTVAL, #{item_seller},
		#{item_title},
		#{item_content}, #{item_category}, #{item_price},
		#{item_place}, #{item_placeX}, #{item_placeY},
		'onsale', sysdate, default, default, null, null)
		INTO
		SHOWCASE(show_index,
		show_item, show_thumb
		<if test="show_img1 != null">
			, show_img1
		</if>
		<if test="show_img2 != null">
			, show_img2
		</if>
		<if test="show_img3 != null">
			, show_img3
		</if>
		<if test="show_img4 != null">
			, show_img4
		</if>
		<if test="show_img5 != null">
			, show_img5
		</if>
		) VALUES (SHOWCASE_SEQ.NEXTVAL,
		ITEM_SEQ.CURRVAL
		, '${show_thumb}'
		<if test="show_img1 != null">
			, '${show_img1}'
		</if>
		<if test="show_img2 != null">
			, '${show_img2}'
		</if>
		<if test="show_img3 != null">
			, '${show_img3}'
		</if>
		<if test="show_img4 != null">
			, '${show_img4}'
		</if>
		<if test="show_img5 != null">
			, '${show_img5}'
		</if>
		)
		SELECT * FROM DUAL
	</insert>
	<update id="updateItem" parameterType="itemInfoDTO">
    <!-- ITEM 테이블 업데이트 -->
    	UPDATE ITEM
    	SET 
	        item_title = #{item_title},
	        item_content = #{item_content},
	        item_category = #{item_category},
	        item_price = #{item_price},
	        item_place = #{item_place},
	        item_placeX = #{item_placeX},
	        item_placeY = #{item_placeY},
	        item_status = #{item_status},
    	WHERE item_index = #{item_index};
    </update>
</mapper>